{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport authorizationAPI from \"./../apis/authorization\";\nimport { Toast } from \"./../utils/helpers\";\nexport default {\n  data() {\n    return {\n      email: \"\",\n      password: \"\",\n      isProcessing: false\n    };\n  },\n\n  methods: {\n    async handleSubmit() {\n      try {\n        //先透過前段做帳號密碼的第一道防線\n        if (!this.email || !this.password) {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"請輸入您的帳號密碼\"\n          });\n          return;\n        }\n\n        this.isProcessing = true; // 原本的.then start--\n\n        const response = await authorizationAPI.signIn({\n          email: this.email,\n          password: this.password\n        });\n        const {\n          data\n        } = response;\n\n        if (data.status !== \"success\") {\n          throw new Error(data.message);\n        } // 將 token 放到 localStorage\n\n\n        localStorage.setItem(\"token\", data.token); //將資料傳到 vuex 中\n\n        this.$store.commit(\"setCurrentUser\", data.user); // 成功登入後轉址到餐廳首頁\n\n        this.$router.push(\"/\"); // 原本的.then end--\n      } catch (error) {\n        this.isProcessing = false;\n        this.password = \"\";\n        Toast.fire({\n          icon: \"warning\",\n          title: \"輸入的帳號密碼有誤\"\n        });\n      }\n    }\n\n  }\n};","map":{"version":3,"mappings":";AAyDA;AACA;AACA;EACAA;IACA;MACAC,SADA;MAEAC,YAFA;MAGAC;IAHA;EAKA,CAPA;;EAQAC;IACA;MACA;QACA;QACA;UACAC;YACAC,eADA;YAEAC;UAFA;UAIA;QACA;;QACA,yBATA,CAUA;;QACA;UACAN,iBADA;UAEAC;QAFA;QAIA;UAAAF;QAAA;;QACA;UACA;QACA,CAlBA,CAmBA;;;QACAQ,0CApBA,CAqBA;;QACA,gDAtBA,CAuBA;;QACA,uBAxBA,CAyBA;MACA,CA1BA,CA0BA;QACA;QACA;QACAH;UACAC,eADA;UAEAC;QAFA;MAIA;IACA;;EApCA;AARA","names":["data","email","password","isProcessing","methods","Toast","icon","title","localStorage"],"sourceRoot":"src/views","sources":["SignIn.vue"],"sourcesContent":["<template>\n<div id=\"signin\">\n  <div class=\"container py-5\">\n    <form class=\"w-100\" @submit.prevent.stop=\"handleSubmit\">\n      <div class=\"text-center mb-4\">\n        <h1 class=\"h3 mb-3 font-weight-normal\">登入微光日植會員</h1>\n      </div>\n\n      <div class=\"form-label-group mb-2\">\n        <label for=\"email\">帳號</label>\n        <input\n          id=\"email\"\n          v-model=\"email\"\n          name=\"email\"\n          type=\"email\"\n          class=\"form-control\"\n          placeholder=\"email\"\n          autocomplete=\"username\"\n          required\n          autofocus\n        />\n      </div>\n\n      <div class=\"form-label-group mb-3\">\n        <label for=\"password\">密碼</label>\n        <input\n          id=\"password\"\n          v-model=\"password\"\n          name=\"password\"\n          type=\"password\"\n          class=\"form-control\"\n          placeholder=\"Password\"\n          autocomplete=\"current-password\"\n          required\n        />\n      </div>\n\n      <button\n        class=\"btn btn-lg btn-primary btn-block mb-3\"\n        type=\"submit\"\n        :disabled=\"isProcessing\"\n      >\n        Submit\n      </button>\n\n      <div class=\"text-center mb-3\">\n        <p>\n          <router-link to=\"/signup\">Sign Up</router-link>\n        </p>\n      </div>\n\n      <p class=\"mt-5 mb-3 text-muted text-center\">&copy; 2021-2022</p>\n    </form>\n  </div>\n  </div>\n</template>\n<script>\nimport authorizationAPI from \"./../apis/authorization\";\nimport { Toast } from \"./../utils/helpers\";\nexport default {\n  data() {\n    return {\n      email: \"\",\n      password: \"\",\n      isProcessing: false,\n    };\n  },\n  methods: {\n    async handleSubmit() {\n      try {\n        //先透過前段做帳號密碼的第一道防線\n        if (!this.email || !this.password) {\n          Toast.fire({\n            icon: \"warning\",\n            title: \"請輸入您的帳號密碼\",\n          });\n          return;\n        }\n        this.isProcessing = true;\n        // 原本的.then start--\n        const response = await authorizationAPI.signIn({\n          email: this.email,\n          password: this.password,\n        });\n        const { data } = response;\n        if (data.status !== \"success\") {\n          throw new Error(data.message);\n        }\n        // 將 token 放到 localStorage\n        localStorage.setItem(\"token\", data.token);\n        //將資料傳到 vuex 中\n        this.$store.commit(\"setCurrentUser\", data.user);\n        // 成功登入後轉址到餐廳首頁\n        this.$router.push(\"/\");\n        // 原本的.then end--\n      } catch (error) {\n        this.isProcessing = false;\n        this.password = \"\";\n        Toast.fire({\n          icon: \"warning\",\n          title: \"輸入的帳號密碼有誤\",\n        });\n      }\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n@import \"./../styles/variables.scss\";\n#signin {\n  margin-top: 65px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n</style>"]},"metadata":{},"sourceType":"module"}